<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Cleaning and wrangling data | Introduction to Data Science</title>
  <meta name="description" content="This is an open source textbook for teaching introductory data science." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Cleaning and wrangling data | Introduction to Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an open source textbook for teaching introductory data science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Cleaning and wrangling data | Introduction to Data Science" />
  
  <meta name="twitter:description" content="This is an open source textbook for teaching introductory data science." />
  

<meta name="author" content="Tiffany-Anne Timbers" />
<meta name="author" content="Melissa Lee" />
<meta name="author" content="Trevor Campbell" />


<meta name="date" content="2019-09-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reading.html">
<link rel="next" href="viz.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to Data Science</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#chapter-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#jupyter-notebooks"><i class="fa fa-check"></i><b>1.2</b> Jupyter notebooks</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#loading-a-spreadsheet-like-dataset"><i class="fa fa-check"></i><b>1.3</b> Loading a spreadsheet-like dataset</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#assigning-value-to-a-data-frame"><i class="fa fa-check"></i><b>1.4</b> Assigning value to a data frame</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#creating-subsets-of-data-frames-with-select-filter"><i class="fa fa-check"></i><b>1.5</b> Creating subsets of data frames with <code>select</code> &amp; <code>filter</code></a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#using-select-to-extract-multiple-columns"><i class="fa fa-check"></i><b>1.5.1</b> Using <code>select</code> to extract multiple columns</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#using-select-to-extract-a-range-of-columns"><i class="fa fa-check"></i><b>1.5.2</b> Using <code>select</code> to extract a range of columns</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#using-filter-to-extract-a-single-row"><i class="fa fa-check"></i><b>1.5.3</b> Using <code>filter</code> to extract a single row</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#using-filter-to-extract-rows-with-values-above-a-threshold"><i class="fa fa-check"></i><b>1.5.4</b> Using <code>filter</code> to extract rows with values above a threshold</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#exploring-data-with-visualizations"><i class="fa fa-check"></i><b>1.6</b> Exploring data with visualizations</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#using-ggplot-to-create-a-scatter-plot"><i class="fa fa-check"></i><b>1.6.1</b> Using <code>ggplot</code> to create a scatter plot</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#using-ggplot-to-create-a-scatter-plot-1"><i class="fa fa-check"></i><b>1.6.2</b> Using <code>ggplot</code> to create a scatter plot</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#formatting-ggplot-objects"><i class="fa fa-check"></i><b>1.6.3</b> Formatting ggplot objects</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#coloring-points-by-group"><i class="fa fa-check"></i><b>1.6.4</b> Coloring points by group</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#putting-it-all-together"><i class="fa fa-check"></i><b>1.6.5</b> Putting it all together</a></li>
<li class="chapter" data-level="1.6.6" data-path="index.html"><a href="index.html#whats-next"><i class="fa fa-check"></i><b>1.6.6</b> What’s next?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>2</b> Reading in data locally and from the web</a><ul>
<li class="chapter" data-level="2.1" data-path="reading.html"><a href="reading.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="reading.html"><a href="reading.html#chapter-learning-objectives-1"><i class="fa fa-check"></i><b>2.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="2.3" data-path="reading.html"><a href="reading.html#absolute-and-relative-file-paths"><i class="fa fa-check"></i><b>2.3</b> Absolute and relative file paths</a></li>
<li class="chapter" data-level="2.4" data-path="reading.html"><a href="reading.html#reading-tabular-data-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading tabular data into R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="reading.html"><a href="reading.html#read_delim-as-a-more-flexible-method-to-get-tabular-data-into-r"><i class="fa fa-check"></i><b>2.4.1</b> <code>read_delim</code> as a more flexible method to get tabular data into R</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading.html"><a href="reading.html#reading-tabular-data-directly-from-a-url"><i class="fa fa-check"></i><b>2.4.2</b> Reading tabular data directly from a URL</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading.html"><a href="reading.html#previewing-a-data-file-before-reading-it-into-r"><i class="fa fa-check"></i><b>2.4.3</b> Previewing a data file before reading it into R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reading.html"><a href="reading.html#scraping-data-off-the-web-using-r"><i class="fa fa-check"></i><b>2.5</b> Scraping data off the web using R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="reading.html"><a href="reading.html#html-and-css-selectors"><i class="fa fa-check"></i><b>2.5.1</b> HTML and CSS selectors</a></li>
<li class="chapter" data-level="2.5.2" data-path="reading.html"><a href="reading.html#are-you-allowed-to-scrape-that-website"><i class="fa fa-check"></i><b>2.5.2</b> Are you allowed to scrape that website?</a></li>
<li class="chapter" data-level="2.5.3" data-path="reading.html"><a href="reading.html#using-rvest"><i class="fa fa-check"></i><b>2.5.3</b> Using <code>rvest</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="reading.html"><a href="reading.html#additional-readingsresources"><i class="fa fa-check"></i><b>2.6</b> Additional readings/resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>3</b> Cleaning and wrangling data</a><ul>
<li class="chapter" data-level="3.1" data-path="wrangling.html"><a href="wrangling.html#overview-1"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="wrangling.html"><a href="wrangling.html#chapter-learning-objectives-2"><i class="fa fa-check"></i><b>3.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="3.3" data-path="wrangling.html"><a href="wrangling.html#vectors-and-data-frames"><i class="fa fa-check"></i><b>3.3</b> Vectors and Data frames</a><ul>
<li class="chapter" data-level="3.3.1" data-path="wrangling.html"><a href="wrangling.html#what-is-a-data-frame"><i class="fa fa-check"></i><b>3.3.1</b> What is a data frame?</a></li>
<li class="chapter" data-level="3.3.2" data-path="wrangling.html"><a href="wrangling.html#what-is-a-vector"><i class="fa fa-check"></i><b>3.3.2</b> What is a vector?</a></li>
<li class="chapter" data-level="3.3.3" data-path="wrangling.html"><a href="wrangling.html#how-are-vectors-different-from-a-list"><i class="fa fa-check"></i><b>3.3.3</b> How are vectors different from a list?</a></li>
<li class="chapter" data-level="3.3.4" data-path="wrangling.html"><a href="wrangling.html#what-does-this-have-to-do-with-data-frames"><i class="fa fa-check"></i><b>3.3.4</b> What does this have to do with data frames?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangling.html"><a href="wrangling.html#the-dplyr-functions"><i class="fa fa-check"></i><b>3.4</b> The <code>dplyr</code> functions</a></li>
<li class="chapter" data-level="3.5" data-path="wrangling.html"><a href="wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.5</b> Tidy Data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="wrangling.html"><a href="wrangling.html#what-is-tidy-data"><i class="fa fa-check"></i><b>3.5.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="3.5.2" data-path="wrangling.html"><a href="wrangling.html#why-is-tidy-data-important-in-r"><i class="fa fa-check"></i><b>3.5.2</b> Why is tidy data important in R?</a></li>
<li class="chapter" data-level="3.5.3" data-path="wrangling.html"><a href="wrangling.html#going-from-wide-to-long-or-tidy-using-gather"><i class="fa fa-check"></i><b>3.5.3</b> Going from wide to long (or tidy!) using <code>gather</code></a></li>
<li class="chapter" data-level="3.5.4" data-path="wrangling.html"><a href="wrangling.html#using-separate-to-deal-with-multiple-delimiters"><i class="fa fa-check"></i><b>3.5.4</b> Using separate to deal with multiple delimiters</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="wrangling.html"><a href="wrangling.html#using-purrrs-map-functions-to-iterate"><i class="fa fa-check"></i><b>3.6</b> Using <code>purrr</code>’s <code>map*</code> functions to iterate</a><ul>
<li class="chapter" data-level="3.6.1" data-path="wrangling.html"><a href="wrangling.html#a-bit-more-about-the-map-functions"><i class="fa fa-check"></i><b>3.6.1</b> A bit more about the <code>map*</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="wrangling.html"><a href="wrangling.html#additional-readingsresources-1"><i class="fa fa-check"></i><b>3.7</b> Additional readings/resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>4</b> Effective data visualization</a><ul>
<li class="chapter" data-level="4.1" data-path="viz.html"><a href="viz.html#overview-2"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="viz.html"><a href="viz.html#chapter-learning-objectives-3"><i class="fa fa-check"></i><b>4.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="4.3" data-path="viz.html"><a href="viz.html#choosing-the-visualization"><i class="fa fa-check"></i><b>4.3</b> Choosing the visualization</a><ul>
<li class="chapter" data-level="4.3.1" data-path="viz.html"><a href="viz.html#the-mauna-loa-co2-dataset"><i class="fa fa-check"></i><b>4.3.1</b> The Mauna Loa CO2 dataset</a></li>
<li class="chapter" data-level="4.3.2" data-path="viz.html"><a href="viz.html#the-old-faithful-eruption-waiting-time-dataset"><i class="fa fa-check"></i><b>4.3.2</b> The Old Faithful eruption / waiting time dataset</a></li>
<li class="chapter" data-level="4.3.3" data-path="viz.html"><a href="viz.html#the-island-landmass-dataset"><i class="fa fa-check"></i><b>4.3.3</b> The island landmass dataset</a></li>
<li class="chapter" data-level="4.3.4" data-path="viz.html"><a href="viz.html#the-michelson-speed-of-light-dataset"><i class="fa fa-check"></i><b>4.3.4</b> The Michelson speed of light dataset</a></li>
<li class="chapter" data-level="4.3.5" data-path="viz.html"><a href="viz.html#the-tooth-growth-dataset"><i class="fa fa-check"></i><b>4.3.5</b> The tooth growth dataset</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="viz.html"><a href="viz.html#refining-the-visualization"><i class="fa fa-check"></i><b>4.4</b> Refining the visualization</a></li>
<li class="chapter" data-level="4.5" data-path="viz.html"><a href="viz.html#explaining-the-visualization"><i class="fa fa-check"></i><b>4.5</b> Explaining the visualization</a></li>
<li class="chapter" data-level="4.6" data-path="viz.html"><a href="viz.html#saving-the-visualization"><i class="fa fa-check"></i><b>4.6</b> Saving the visualization</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="GitHub.html"><a href="GitHub.html"><i class="fa fa-check"></i><b>5</b> Version control with GitHub</a><ul>
<li class="chapter" data-level="5.1" data-path="GitHub.html"><a href="GitHub.html#overview-3"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="GitHub.html"><a href="GitHub.html#videos-to-learn-about-version-control-with-github-and-git"><i class="fa fa-check"></i><b>5.2</b> Videos to learn about version control with GitHub and Git</a><ul>
<li class="chapter" data-level="5.2.1" data-path="GitHub.html"><a href="GitHub.html#creating-a-github-repository"><i class="fa fa-check"></i><b>5.2.1</b> Creating a GitHub repository</a></li>
<li class="chapter" data-level="5.2.2" data-path="GitHub.html"><a href="GitHub.html#exploring-a-github-repository"><i class="fa fa-check"></i><b>5.2.2</b> Exploring a GitHub repository</a></li>
<li class="chapter" data-level="5.2.3" data-path="GitHub.html"><a href="GitHub.html#directly-editing-files-on-github"><i class="fa fa-check"></i><b>5.2.3</b> Directly editing files on GitHub</a></li>
<li class="chapter" data-level="5.2.4" data-path="GitHub.html"><a href="GitHub.html#logging-changes-and-pushing-them-to-github"><i class="fa fa-check"></i><b>5.2.4</b> Logging changes and pushing them to GitHub</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="GitHub.html"><a href="GitHub.html#git-command-cheatsheet"><i class="fa fa-check"></i><b>5.3</b> Git command cheatsheet</a><ul>
<li class="chapter" data-level="5.3.1" data-path="GitHub.html"><a href="GitHub.html#getting-a-repository-from-github-onto-the-server-for-the-first-time"><i class="fa fa-check"></i><b>5.3.1</b> Getting a repository from GitHub onto the server for the first time</a></li>
<li class="chapter" data-level="5.3.2" data-path="GitHub.html"><a href="GitHub.html#logging-changes"><i class="fa fa-check"></i><b>5.3.2</b> Logging changes</a></li>
<li class="chapter" data-level="5.3.3" data-path="GitHub.html"><a href="GitHub.html#sending-your-changes-back-to-github"><i class="fa fa-check"></i><b>5.3.3</b> Sending your changes back to GitHub</a></li>
<li class="chapter" data-level="5.3.4" data-path="GitHub.html"><a href="GitHub.html#getting-changes"><i class="fa fa-check"></i><b>5.3.4</b> Getting changes</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="GitHub.html"><a href="GitHub.html#terminal-cheatsheet"><i class="fa fa-check"></i><b>5.4</b> Terminal cheatsheet</a><ul>
<li class="chapter" data-level="5.4.1" data-path="GitHub.html"><a href="GitHub.html#see-where-you-are"><i class="fa fa-check"></i><b>5.4.1</b> See where you are:</a></li>
<li class="chapter" data-level="5.4.2" data-path="GitHub.html"><a href="GitHub.html#see-what-is-inside-the-directory-where-you-are"><i class="fa fa-check"></i><b>5.4.2</b> See what is inside the directory where you are:</a></li>
<li class="chapter" data-level="5.4.3" data-path="GitHub.html"><a href="GitHub.html#move-to-a-different-directory"><i class="fa fa-check"></i><b>5.4.3</b> Move to a different directory</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>6</b> Classification</a><ul>
<li class="chapter" data-level="6.1" data-path="classification.html"><a href="classification.html#overview-4"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="classification.html"><a href="classification.html#learning-objectives"><i class="fa fa-check"></i><b>6.2</b> Learning objectives</a></li>
<li class="chapter" data-level="6.3" data-path="classification.html"><a href="classification.html#classification"><i class="fa fa-check"></i><b>6.3</b> Classification</a></li>
<li class="chapter" data-level="6.4" data-path="classification.html"><a href="classification.html#wisconsin-breast-cancer-example"><i class="fa fa-check"></i><b>6.4</b> Wisconsin Breast Cancer Example:</a><ul>
<li class="chapter" data-level="6.4.1" data-path="classification.html"><a href="classification.html#data-exploration"><i class="fa fa-check"></i><b>6.4.1</b> Data Exploration</a></li>
<li class="chapter" data-level="6.4.2" data-path="classification.html"><a href="classification.html#k-nearest-neighbour-classifier"><i class="fa fa-check"></i><b>6.4.2</b> K-Nearest Neighbour Classifier</a></li>
<li class="chapter" data-level="6.4.3" data-path="classification.html"><a href="classification.html#k-nearest-neighbours-in-r"><i class="fa fa-check"></i><b>6.4.3</b> K-Nearest Neighbours in R</a></li>
<li class="chapter" data-level="6.4.4" data-path="classification.html"><a href="classification.html#more-than-two-explanatory-variablespredictors"><i class="fa fa-check"></i><b>6.4.4</b> More than two explanatory variables/predictors</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="classification.html"><a href="classification.html#additional-readingsresources-2"><i class="fa fa-check"></i><b>6.5</b> Additional readings/resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="classification-continued.html"><a href="classification-continued.html"><i class="fa fa-check"></i><b>7</b> Classification continued</a><ul>
<li class="chapter" data-level="7.1" data-path="classification-continued.html"><a href="classification-continued.html#overview-5"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="classification-continued.html"><a href="classification-continued.html#learning-objectives-1"><i class="fa fa-check"></i><b>7.2</b> Learning objectives</a></li>
<li class="chapter" data-level="7.3" data-path="classification-continued.html"><a href="classification-continued.html#assessing-how-good-your-classifier-is"><i class="fa fa-check"></i><b>7.3</b> Assessing how good your classifier is</a><ul>
<li class="chapter" data-level="7.3.1" data-path="classification-continued.html"><a href="classification-continued.html#assessing-your-classifier-in-r"><i class="fa fa-check"></i><b>7.3.1</b> Assessing your classifier in R</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="classification-continued.html"><a href="classification-continued.html#cross-validation-for-assessing-classifier-quality"><i class="fa fa-check"></i><b>7.4</b> Cross-validation for assessing classifier quality</a></li>
<li class="chapter" data-level="7.5" data-path="classification-continued.html"><a href="classification-continued.html#choosing-the-number-of-neighbours-for-k-nn-classification"><i class="fa fa-check"></i><b>7.5</b> Choosing the number of neighbours for k-nn classification</a></li>
<li class="chapter" data-level="7.6" data-path="classification-continued.html"><a href="classification-continued.html#other-ways-to-increase-accuracy"><i class="fa fa-check"></i><b>7.6</b> Other ways to increase accuracy</a></li>
<li class="chapter" data-level="7.7" data-path="classification-continued.html"><a href="classification-continued.html#test-data-set"><i class="fa fa-check"></i><b>7.7</b> Test data set</a></li>
<li class="chapter" data-level="7.8" data-path="classification-continued.html"><a href="classification-continued.html#scaling-your-data"><i class="fa fa-check"></i><b>7.8</b> Scaling your data</a></li>
<li class="chapter" data-level="7.9" data-path="classification-continued.html"><a href="classification-continued.html#strengths-and-limitations-of-k-nn-classification"><i class="fa fa-check"></i><b>7.9</b> Strengths and limitations of k-nn classification</a><ul>
<li class="chapter" data-level="7.9.1" data-path="classification-continued.html"><a href="classification-continued.html#strengths-of-k-nn-classification"><i class="fa fa-check"></i><b>7.9.1</b> Strengths of k-nn classification</a></li>
<li class="chapter" data-level="7.9.2" data-path="classification-continued.html"><a href="classification-continued.html#limitations-of-k-nn-classification"><i class="fa fa-check"></i><b>7.9.2</b> Limitations of k-nn classification</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="classification-continued.html"><a href="classification-continued.html#additional-readingsresources-3"><i class="fa fa-check"></i><b>7.10</b> Additional readings/resources</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression1.html"><a href="regression1.html"><i class="fa fa-check"></i><b>8</b> Introduction to regression through K-nearest neighbours</a><ul>
<li class="chapter" data-level="8.1" data-path="regression1.html"><a href="regression1.html#overview-6"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="regression1.html"><a href="regression1.html#learning-objectives-2"><i class="fa fa-check"></i><b>8.2</b> Learning objectives</a></li>
<li class="chapter" data-level="8.3" data-path="regression1.html"><a href="regression1.html#regression"><i class="fa fa-check"></i><b>8.3</b> Regression</a></li>
<li class="chapter" data-level="8.4" data-path="regression1.html"><a href="regression1.html#sacremento-real-estate-example"><i class="fa fa-check"></i><b>8.4</b> Sacremento real estate example</a></li>
<li class="chapter" data-level="8.5" data-path="regression1.html"><a href="regression1.html#k-nearest-neighbours-regression"><i class="fa fa-check"></i><b>8.5</b> K-nearest neighbours regression</a></li>
<li class="chapter" data-level="8.6" data-path="regression1.html"><a href="regression1.html#assessing-a-knn-regression-model"><i class="fa fa-check"></i><b>8.6</b> Assessing a knn regression model</a></li>
<li class="chapter" data-level="8.7" data-path="regression1.html"><a href="regression1.html#how-do-different-ks-affect-k-nn-regression-predictions"><i class="fa fa-check"></i><b>8.7</b> How do different k’s affect k-nn regression predictions</a></li>
<li class="chapter" data-level="8.8" data-path="regression1.html"><a href="regression1.html#assessing-model-goodness-with-the-test-set"><i class="fa fa-check"></i><b>8.8</b> Assessing model goodness with the test set</a></li>
<li class="chapter" data-level="8.9" data-path="regression1.html"><a href="regression1.html#strengths-and-limitations-of-k-nn-regression"><i class="fa fa-check"></i><b>8.9</b> Strengths and limitations of k-nn regression</a><ul>
<li class="chapter" data-level="8.9.1" data-path="regression1.html"><a href="regression1.html#strengths-of-k-nn-regression"><i class="fa fa-check"></i><b>8.9.1</b> Strengths of k-nn regression</a></li>
<li class="chapter" data-level="8.9.2" data-path="regression1.html"><a href="regression1.html#limitations-of-k-nn-regression"><i class="fa fa-check"></i><b>8.9.2</b> Limitations of k-nn regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression2.html"><a href="regression2.html"><i class="fa fa-check"></i><b>9</b> Regression, continued</a><ul>
<li class="chapter" data-level="9.1" data-path="regression2.html"><a href="regression2.html#overview-7"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="regression2.html"><a href="regression2.html#learning-objectives-3"><i class="fa fa-check"></i><b>9.2</b> Learning objectives</a></li>
<li class="chapter" data-level="9.3" data-path="regression2.html"><a href="regression2.html#rmse-versus-rmpse"><i class="fa fa-check"></i><b>9.3</b> <span class="math inline">\(RMSE\)</span> versus <span class="math inline">\(RMPSE\)</span></a></li>
<li class="chapter" data-level="9.4" data-path="regression2.html"><a href="regression2.html#linear-regression"><i class="fa fa-check"></i><b>9.4</b> Linear regression</a></li>
<li class="chapter" data-level="9.5" data-path="regression2.html"><a href="regression2.html#linear-regression-in-r-using-caret"><i class="fa fa-check"></i><b>9.5</b> Linear regression in R using <code>caret</code></a></li>
<li class="chapter" data-level="9.6" data-path="regression2.html"><a href="regression2.html#comparing-linear-and-k-nn-regression"><i class="fa fa-check"></i><b>9.6</b> Comparing linear and k-nn regression</a></li>
<li class="chapter" data-level="9.7" data-path="regression2.html"><a href="regression2.html#additional-readingsresources-4"><i class="fa fa-check"></i><b>9.7</b> Additional readings/resources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regression3.html"><a href="regression3.html"><i class="fa fa-check"></i><b>10</b> Regression, continued some more…</a><ul>
<li class="chapter" data-level="10.1" data-path="regression3.html"><a href="regression3.html#overview-8"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="regression3.html"><a href="regression3.html#learning-objectives-4"><i class="fa fa-check"></i><b>10.2</b> Learning objectives</a></li>
<li class="chapter" data-level="10.3" data-path="regression3.html"><a href="regression3.html#multivariate-k-nn-regression"><i class="fa fa-check"></i><b>10.3</b> Multivariate k-nn regression</a></li>
<li class="chapter" data-level="10.4" data-path="regression3.html"><a href="regression3.html#multivariate-linear-regression"><i class="fa fa-check"></i><b>10.4</b> Multivariate linear regression</a></li>
<li class="chapter" data-level="10.5" data-path="regression3.html"><a href="regression3.html#the-other-side-of-regression"><i class="fa fa-check"></i><b>10.5</b> The other side of regression</a></li>
<li class="chapter" data-level="10.6" data-path="regression3.html"><a href="regression3.html#additional-readingsresources-5"><i class="fa fa-check"></i><b>10.6</b> Additional readings/resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>11</b> Clustering</a><ul>
<li class="chapter" data-level="11.1" data-path="clustering.html"><a href="clustering.html#overview-9"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="clustering.html"><a href="clustering.html#learning-objectives-5"><i class="fa fa-check"></i><b>11.2</b> Learning objectives</a></li>
<li class="chapter" data-level="11.3" data-path="clustering.html"><a href="clustering.html#clustering"><i class="fa fa-check"></i><b>11.3</b> Clustering</a><ul>
<li class="chapter" data-level="11.3.1" data-path="clustering.html"><a href="clustering.html#a-toy-example"><i class="fa fa-check"></i><b>11.3.1</b> A toy example</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="clustering.html"><a href="clustering.html#k-means-clustering-algorithm"><i class="fa fa-check"></i><b>11.4</b> K-means clustering algorithm</a></li>
<li class="chapter" data-level="11.5" data-path="clustering.html"><a href="clustering.html#k-means-clustering-in-r"><i class="fa fa-check"></i><b>11.5</b> K-means clustering in R</a></li>
<li class="chapter" data-level="11.6" data-path="clustering.html"><a href="clustering.html#choosing-k-for-k-means-clustering"><i class="fa fa-check"></i><b>11.6</b> Choosing K for K-means clustering</a></li>
<li class="chapter" data-level="11.7" data-path="clustering.html"><a href="clustering.html#additional-readings"><i class="fa fa-check"></i><b>11.7</b> Additional readings:</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wrangling" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Cleaning and wrangling data</h1>
<div id="overview-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Overview</h2>
<p>This chapter will be centered around tools for cleaning and wrangling data. Again, this will be in the context of a real world Data Science application and we will continue to practice working through a whole case study</p>
</div>
<div id="chapter-learning-objectives-2" class="section level2">
<h2><span class="header-section-number">3.2</span> Chapter learning objectives</h2>
<p>By the end of the chapter, students will be able to:</p>
<ul>
<li>define the term “tidy data”</li>
<li>discuss the advantages and disadvantages from storing data in a tidy data format</li>
<li>recall and use the following tidyverse functions and operators for their intended data wrangling tasks:
<ul>
<li><code>select</code></li>
<li><code>filter</code></li>
<li><code>%&gt;%</code></li>
<li><code>map</code></li>
<li><code>mutate</code></li>
<li><code>summarise</code></li>
<li><code>group_by</code></li>
<li><code>gather</code></li>
<li><code>separate</code></li>
<li><code>%in%</code></li>
</ul></li>
</ul>
</div>
<div id="vectors-and-data-frames" class="section level2">
<h2><span class="header-section-number">3.3</span> Vectors and Data frames</h2>
<p>At this point, we know how to load flat, tabular data files into R using the <code>tidyverse</code> functions. When we do this, the data is represented in R as a data frame object. So now, we will spend some time learning more about these types of objects in R and what they are made up of so that we have a better understanding of how we can use and manipulate these objects.</p>
<div id="what-is-a-data-frame" class="section level3">
<h3><span class="header-section-number">3.3.1</span> What is a data frame?</h3>
<p>Let’s first start by defining exactly what a data frame is. From a data perspective, it is a rectangle where the rows are the observations.</p>
<div class="figure">
<img src="img/obs.jpeg" />

</div>
<p>And the columns are the variables. Data frames in R are built-in, base R objects.</p>
<div class="figure">
<img src="img/vars.jpeg" />

</div>
<p>From a computer science type/object perspective, in R, a data frame is a special sub-type of a list object whose elements (columns) are vectors.</p>
<div class="figure">
<img src="img/vectors.jpeg" />

</div>
</div>
<div id="what-is-a-vector" class="section level3">
<h3><span class="header-section-number">3.3.2</span> What is a vector?</h3>
<p>In R, vectors are objects that can contain 1 or more elements. The vector elements are ordered, and they must all be of the same type. They are also mutable. Vectors are also built-in, base R objects.</p>
<div class="figure">
<img src="img/vector.jpeg" />

</div>
</div>
<div id="how-are-vectors-different-from-a-list" class="section level3">
<h3><span class="header-section-number">3.3.3</span> How are vectors different from a list?</h3>
<p>Vectors and lists differ by the requirement of element type consistency. All elements within a single vector must be of the same type (e.g., all elements are strings), whereas elements within a single list can be of different types (e.g., strings and numbers can be elements in the same list).</p>
<div class="figure">
<img src="img/vec_vs_list.jpeg" />

</div>
</div>
<div id="what-does-this-have-to-do-with-data-frames" class="section level3">
<h3><span class="header-section-number">3.3.4</span> What does this have to do with data frames?</h3>
<p>As mentioned earlier, data frames are really specialized lists of vectors that allow us to easily work with our data in a rectangular/spreadsheet like manner. This allows us have columns/vectors of different characteristics associated/linked in one object similar to a table in a database.</p>
<div class="figure">
<img src="img/dataframe.jpeg" />

</div>
</div>
</div>
<div id="the-dplyr-functions" class="section level2">
<h2><span class="header-section-number">3.4</span> The <code>dplyr</code> functions</h2>
<p>We haven’t explicitly said this yet, but the <code>tidyverse</code> is actually a meta R package that installs a collection of R packages that all follow the tidy data philosophy (more on this below). One of the tidyverse packages is <code>dplyr</code> - a data wrangling workhorse. You have already met 3 of the dplyr function (<code>select</code>, <code>filter</code> and <code>mutate</code>). To learn more about those three and meet a few more useful ones, read the post at this link: <a href="http://stat545.com/block010_dplyr-end-single-table.html#where-were-we" class="uri">http://stat545.com/block010_dplyr-end-single-table.html#where-were-we</a></p>
</div>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">3.5</span> Tidy Data</h2>
<p>There are many ways a spreadsheet-like dataset can be organized. In this chapter we are going to focus on the tidy data format of organization, and how to make your messy data tidy. This is because a variety of tools we would like to be able to use in R are designed to work most effectively (and efficiently) with tidy data.</p>
<div id="what-is-tidy-data" class="section level3">
<h3><span class="header-section-number">3.5.1</span> What is tidy data?</h3>
<p>A tidy data is one that is satified by these three criteria:</p>
<ul>
<li>each row is a single observation,</li>
<li>each variable is a single column, and</li>
<li>each value is a single cell (i.e., its row, column position in the data frame is not shared with another value)</li>
</ul>
<p><img src="https://d33wubrfki0l68.cloudfront.net/6f1ddb544fc5c69a2478e444ab8112fb0eea23f8/91adc/images/tidy-1.png" /> <em>image source: <a href="https://r4ds.had.co.nz/">R for Data Science</a> by Garrett Grolemund &amp; Hadley Wickham</em></p>
</div>
<div id="why-is-tidy-data-important-in-r" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Why is tidy data important in R?</h3>
<p>First, many tidyverse data cleaning/wrangling tools work best with tidy data. Second, one of the most popular plotting tools in R, the <code>ggplot2</code> functions, expect data in tidy format. Third most statistical analysis functions expect data in tidy format. In contrast to Python and other programming languages, in R you do not need to manually create dummy variables to represent your categorical data for its statistical or machine learning tools. R does this for you under the hood through factorization, but your data must be tidy for this to work. Given that all of these tasks are central features to virtually any data analysis project it is well worth spending the time to get your data into a tidy format up front. Now let’s explore how we can do this in R.</p>
</div>
<div id="going-from-wide-to-long-or-tidy-using-gather" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Going from wide to long (or tidy!) using <code>gather</code></h3>
<p>One common thing that often has to be done to get data into a tidy format is to gather columns so that each row is a single observation and each column is a single variable. Often times data does not come this way, as although tidy data is a better organization structure for data analysis, it is not as intuitive of a data organization structure for human readability and understanding.</p>
<p>For example, the we read in data below is not in tidy format, but is in a very intuitive format for human understanding:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<pre><code>hist_vote_wide &lt;- read_csv(&quot;historical_vote_wide.csv&quot;)
head(hist_vote_wide)</code></pre>
<pre><code># A tibble: 6 x 3
  election_year winner       runnerup       
          &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;          
1          2016 Donald Trump Hillary Clinton
2          2012 Barack Obama Mitt Romney    
3          2008 Barack Obama John McCain    
4          2004 George Bush  John Kerry     
5          2000 George Bush  Al Gore        
6          1996 Bill Clinton Bob Dole    </code></pre>
<p>What is wrong with our untidy format above? From a data analysis perspective, this format is not idead because in this format the outcome of the variable “result” (winner or runner up) is stored as column names and not easily accessible for the functions we will desire to apply to our data set. Additionally, the values of the “candidate” variable is spread across two columns and will require some sort of binding or joining to get them into one single column to allow us to do our desired visualization and statistical tasks later on.</p>
<p>To accomplish this data tranformation we will use the <code>tidyverse</code> function <code>gather</code>. To use gather we need to specify:</p>
<ol style="list-style-type: decimal">
<li><p>the dataset</p></li>
<li><p>the key which is the name of a new column that will be created and whose values will come from names of the columns that we want to combine (here <code>result</code>)</p></li>
<li><p>the value which is the name of a new column that will be created and whose values will come from the values of the columns we want to combine (here <code>value</code>)</p></li>
<li><p>the names of the columns that we want to combine (we list these after specifying the key and value and separate the column names with commas)</p></li>
</ol>
<p>For our example we would use gather to combine the winner and runnerup columns into a single column called candidate, and create a column called result that contains the outcome of the election for each candidate:</p>
<pre><code>hist_vote_tidy &lt;- hist_vote_wide %&gt;% 
  gather(key = result, value = candidate, winner, runnerup)
         
print(hist_vote_tidy)</code></pre>
<pre><code># A tibble: 20 x 3
   election_year result   candidate      
           &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          
 1          2016 winner   Donald Trump   
 2          2012 winner   Barack Obama   
 3          2008 winner   Barack Obama   
 4          2004 winner   George W Bush  
 5          2000 winner   George W Bush  
 6          1996 winner   Bill Clinton   
 7          1992 winner   Bill Clinton   
 8          1988 winner   George HW Bush 
 9          1984 winner   Ronald Reagan  
10          1980 winner   Ronald Reagan  
11          2016 runnerup Hillary Clinton
12          2012 runnerup Mitt Romney    
13          2008 runnerup John McCain    
14          2004 runnerup John Kerry     
15          2000 runnerup Al Gore        
16          1996 runnerup Bob Dole       
17          1992 runnerup George HW Bush 
18          1988 runnerup Michael Dukakis
19          1984 runnerup Walter Mondale 
20          1980 runnerup Jimmy Carter         </code></pre>
</div>
<div id="using-separate-to-deal-with-multiple-delimiters" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Using separate to deal with multiple delimiters</h3>
<p>Data is also not considered tidy when multiple values are stored in the same cell. We can see that in addition to the previous untidy problem we faced with the earlier version of this data set, the one we show below is even messier because the winner and runnerup columns contain both the candidate’s name as well as the party they were a member of. To make this messy data tidy we’ll have to fix both of these issues.</p>
<pre><code>hist_vote_messy &lt;- read_csv(&quot;historical_vote_messy.csv&quot;)
print(hist_vote_messy)</code></pre>
<pre><code># A tibble: 10 x 3
   election_year winner             runnerup           
           &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;              
 1          2016 Donald Trump/Rep   Hillary Clinton/Dem
 2          2012 Barack Obama/Dem   Mitt Romney/Rep    
 3          2008 Barack Obama/Dem   John McCain/Rep    
 4          2004 George W Bush/Rep  John Kerry/Dem     
 5          2000 George W Bush/Rep  Al Gore/Dem        
 6          1996 Bill Clinton/Dem   Bob Dole/Rep       
 7          1992 Bill Clinton/Dem   George HW Bush/Rep 
 8          1988 George HW Bush/Rep Michael Dukakis/Dem
 9          1984 Ronald Reagan/Rep  Walter Mondale/Dem 
10          1980 Ronald Reagan/Rep  Jimmy Carter/Dem </code></pre>
<p>First we’ll use gather to create the result and candidate column as we did previously:</p>
<pre><code>gather(hist_vote_messy, 
                         key = result, 
                         value = candidate, 
                         winner, 
                         runnerup)</code></pre>
<pre><code># A tibble: 20 x 3
   election_year result   candidate          
           &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;              
 1          2016 winner   Donald Trump/Rep   
 2          2012 winner   Barack Obama/Dem   
 3          2008 winner   Barack Obama/Dem   
 4          2004 winner   George W Bush/Rep  
 5          2000 winner   George W Bush/Rep  
 6          1996 winner   Bill Clinton/Dem   
 7          1992 winner   Bill Clinton/Dem   
 8          1988 winner   George HW Bush/Rep 
 9          1984 winner   Ronald Reagan/Rep  
10          1980 winner   Ronald Reagan/Rep  
11          2016 runnerup Hillary Clinton/Dem
12          2012 runnerup Mitt Romney/Rep    
13          2008 runnerup John McCain/Rep    
14          2004 runnerup John Kerry/Dem     
15          2000 runnerup Al Gore/Dem        
16          1996 runnerup Bob Dole/Rep       
17          1992 runnerup George HW Bush/Rep 
18          1988 runnerup Michael Dukakis/Dem
19          1984 runnerup Walter Mondale/Dem 
20          1980 runnerup Jimmy Carter/Dem </code></pre>
<p>And then we separate to split the candidate column into two columns, one called candidate that now contains only the candidate’s name, and called party that contains a short identifier for which political party the candidate belonged to:</p>
<pre><code>gather(hist_vote_messy, 
                         key = result, 
                         value = candidate, 
                         winner, 
                         runnerup) %&gt;% 
  separate(col = candidate, 
         into = c(&quot;candidate&quot;, &quot;party&quot;), 
         sep = &quot;/&quot;) </code></pre>
<pre><code># A tibble: 20 x 4
   election_year result   candidate       party
           &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;
 1          2016 winner   Donald Trump    Rep  
 2          2012 winner   Barack Obama    Dem  
 3          2008 winner   Barack Obama    Dem  
 4          2004 winner   George W Bush   Rep  
 5          2000 winner   George W Bush   Rep  
 6          1996 winner   Bill Clinton    Dem  
 7          1992 winner   Bill Clinton    Dem  
 8          1988 winner   George HW Bush  Rep  
 9          1984 winner   Ronald Reagan   Rep  
10          1980 winner   Ronald Reagan   Rep  
11          2016 runnerup Hillary Clinton Dem  
12          2012 runnerup Mitt Romney     Rep  
13          2008 runnerup John McCain     Rep  
14          2004 runnerup John Kerry      Dem  
15          2000 runnerup Al Gore         Dem  
16          1996 runnerup Bob Dole        Rep  
17          1992 runnerup George HW Bush  Rep  
18          1988 runnerup Michael Dukakis Dem  
19          1984 runnerup Walter Mondale  Dem  
20          1980 runnerup Jimmy Carter    Dem  </code></pre>
</div>
</div>
<div id="using-purrrs-map-functions-to-iterate" class="section level2">
<h2><span class="header-section-number">3.6</span> Using <code>purrr</code>’s <code>map*</code> functions to iterate</h2>
<p>Where should you turn when you discover the next step in your data wrangling/cleaning process requires you to apply a function to each column in a data frame? For example, if you wanted to know the maximum value of each column in a data frame, you could use <code>purrr</code>’s <code>map</code> function to apply the <code>max</code> function to each column. For example, let’s do that and find that maximum value of each column of the <code>mtcars</code> data frame (a built-in data set that comes with R). First, let’s peak at an become familiar with the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mtcars)</code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>Next, we can use <code>map</code> to apply the <code>max</code> function to each column. <code>map</code> takes two arguments, an object (a vector, data frame or list) that you want to apply the function to, and the function that you would like to apply. Here our arguments will be <code>mtcars</code> and <code>max</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">max_of_columns &lt;-<span class="st"> </span><span class="kw">map</span>(mtcars, max)
max_of_columns</code></pre></div>
<pre><code>## $mpg
## [1] 33.9
## 
## $cyl
## [1] 8
## 
## $disp
## [1] 472
## 
## $hp
## [1] 335
## 
## $drat
## [1] 4.93
## 
## $wt
## [1] 5.424
## 
## $qsec
## [1] 22.9
## 
## $vs
## [1] 1
## 
## $am
## [1] 1
## 
## $gear
## [1] 5
## 
## $carb
## [1] 8</code></pre>
<blockquote>
<h5 id="note"><span class="header-section-number">3.6</span> Note:</h5>
<p><code>purrr</code> is part of the tidyverse, and so like the <code>dplyr</code> and <code>ggplot</code> functions, once we call <code>library(tidyverse)</code> we do not need to separately load the <code>purrr</code> package.</p>
</blockquote>
<p>Our output looks a bit weird though? We passed in a data frame, but our output doesn’t look like a data frame… And that it because it isn’t, its a plain vanilla list:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(max_of_columns)</code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>So what do we do? Convert this to a data frame? No need, what we should do instead is to use a different <code>map*</code> function from the <code>purrr</code> package. There are quite a few to choose from, they all work similarly and their name refects the type of output you want from the mapping operation:</p>
<table>
<thead>
<tr class="header">
<th><code>map</code> function</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>map()</code></td>
<td>list</td>
</tr>
<tr class="even">
<td><code>map_lgl()</code></td>
<td>logical vector</td>
</tr>
<tr class="odd">
<td><code>map_int()</code></td>
<td>integer vector</td>
</tr>
<tr class="even">
<td><code>map_dbl()</code></td>
<td>double vector</td>
</tr>
<tr class="odd">
<td><code>map_chr()</code></td>
<td>character vector</td>
</tr>
<tr class="even">
<td><code>map_df()</code></td>
<td>data frame</td>
</tr>
</tbody>
</table>
<p>So let’s get the column maximum’s again, but this time use the <code>map_df</code> function to return the output as a data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">max_of_columns &lt;-<span class="st"> </span><span class="kw">map_df</span>(mtcars, max)
max_of_columns</code></pre></div>
<pre><code>## # A tibble: 1 x 11
##     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  33.9     8   472   335  4.93  5.42  22.9     1     1     5     8</code></pre>
<p>Do we always want to use <code>map_df</code>? Nope! It depends what we are trying to do. So before you choose your <code>map*</code> function, think about your downstream usage of the output of that function.</p>
<p>What if you need to add other arguments to the functions you want to map? For example, what if there were NA values in our columns that we wanted to know the maximum of? Well then we also need to add the argument <code>na.rm  = TRUE</code> to the <code>max</code> function so that we get a more useful value than NA returned (remember that is what happens with many of the built-in R statistical functions when NA’s are present…). What we need to do in that case is do what is called “creating an anonymous function” within the <code>map_df</code> function. We do that in the place where we previously specified our max function. Here we will put the two calls to <code>map_df</code> right after each other so you can see the difference:</p>
<pre><code># no additional arguments to the max function 
map_df(mtcars, max)</code></pre>
<p>versus</p>
<pre><code># adding the na.rm  = TRUE argument to the max function
map_df(mtcars, function(df) max(df, na.rm  = TRUE))</code></pre>
<p>You can see that’s quite a bit of extra typing… So the creators of <code>purrr</code> have made a shortcut for this because it is so commonly done. In the shortcut we replace <code>function(VARIABLE)</code> with a <code>~</code> and replace the <code>VARIABLE</code> in the function call with a <code>.</code>, see the example below:</p>
<pre><code># adding the na.rm  = TRUE argument to the max function using the shortcut 
map_df(mtcars, ~ max(., na.rm  = TRUE))</code></pre>
<div id="a-bit-more-about-the-map-functions" class="section level3">
<h3><span class="header-section-number">3.6.1</span> A bit more about the <code>map*</code> functions</h3>
<p>The <code>map</code> functions are generally quite useful for solving many iteration/repetition problems. It’s use does not have to be limited to columns of a data frame. It can be used to apply functions to elements of a vector or list, rows of a data frame (using <code>pmap</code>), and even to lists of data frames, or nested data frames.</p>
</div>
</div>
<div id="additional-readingsresources-1" class="section level2">
<h2><span class="header-section-number">3.7</span> Additional readings/resources</h2>
<ul>
<li><a href="https://r4ds.had.co.nz/transform.html">Data transformation chapter</a> from <a href="https://r4ds.had.co.nz/">R for Data Science</a> by Garrett Grolemund &amp; Hadley Wickham</li>
<li><a href="https://r4ds.had.co.nz/tidy-data.html">Tidy data chapter</a> from <a href="https://r4ds.had.co.nz/">R for Data Science</a> by Garrett Grolemund &amp; Hadley Wickham</li>
<li><a href="https://r4ds.had.co.nz/iteration.html#the-map-functions">The <code>map</code> functions</a> from <a href="https://r4ds.had.co.nz/">R for Data Science</a> by Garrett Grolemund &amp; Hadley Wickham</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reading.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="viz.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-wrangling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
